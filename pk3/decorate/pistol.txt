Actor NewPistol : Weapon Replaces Pistol
{
	Weapon.Ammotype1 "LoadedPistol"	
	Weapon.Ammogive1 8
	Weapon.Ammouse1 1
	Weapon.Ammotype2 "Clip"

	+WEAPON.NOAUTOFIRE
	+WEAPON.AMMO_OPTIONAL
	
	States
	{
		Ready:
			PISG A 1 A_WeaponReady
			Loop
		Deselect:
			PISG A 1 A_Lower
			Loop
		Select:
			PISG A 1 A_Raise
			Loop
		Fire:
			TNT1 A 0 A_JumpIfNoAmmo("ReloadStart")
			TNT1 A 0 A_PlaySound("weapons/pistol", CHAN_WEAPON)
			TNT1 A 0 A_GunFlash
			PISG B 2 A_FireCustomMissile("PistolBullet", 0, 1, 0, 0, 0, 0)
			PISG BB 1 A_WeaponReady
			PISG CCC 1 A_WeaponReady
			PISG BB 1 A_WeaponReady
			Goto Ready
		Flash:
			PISF A 3 Bright A_Light1
			Goto LightDone
			PISF A 3 Bright A_Light1
			Goto LightDone
		Spawn:
			PIST A -1
			Stop
		AltFire:
			PISG A 1 Offset(-4, 54)
			PISG A 1 Offset(-10, 68)
			RPUN B 1 Offset(0, 32)
			RPUN C 2 A_CustomPunch(40, 1, 4, "MeleePuff")
			RPUN D 8
			RPUN C 7
			Goto Ready
		ReloadStart:
			TNT1 A 0 A_JumpIfInventory("Clip", 1, "ReloadStart2")
			Goto ReloadFail
		ReloadStart2:
			PISG A 1 Offset(0, 32)
			PISG A 1 Offset(0, 34)
			PISG A 1 Offset(0, 36)
			PISG A 1 Offset(0, 38)
			PISG A 1 Offset(0, 40)
			PISG A 1 Offset(0, 42)
			PISG A 1 Offset(0, 44)
			PISG A 1 Offset(0, 46)
			PISG A 1 Offset(0, 48)
			PISG A 1 Offset(0, 50)
			PISG A 1 Offset(0, 52)
			PISG A 1 Offset(0, 54)
			PISG A 1 Offset(0, 56)
			PISG A 1 Offset(0, 58)
			PISG A 1 Offset(0, 60)
			PISG A 2 Offset(0, 62)
			PISG A 18 Offset(0, 64)
			Goto ReloadLoop
		ReloadLoop:
			TNT1 A 0 A_TakeInventory("Clip", 1)
			TNT1 A 0 A_GiveInventory("LoadedPistol", 1)
			TNT1 A 0 A_JumpIfInventory("LoadedPistol", 0, "ReloadEnd")
			TNT1 A 0 A_JumpIfInventory("Clip", 1, "ReloadLoop")
		ReloadFail:
			PISG A 1
			Goto Ready
		ReloadEnd:
			PISG A 2 Offset(0, 62)
			PISG A 2 Offset(0, 59)
			PISG A 2 Offset(0, 56)
			PISG A 2 Offset(0, 53)
			PISG A 2 Offset(0, 50)
			PISG A 2 Offset(0, 47)
			PISG A 2 Offset(0, 44)
			PISG A 2 Offset(0, 41)
			PISG A 2 Offset(0, 38)
			PISG A 2 Offset(0, 35)
			PISG A 2 Offset(0, 32)
			Goto Ready
			
	}
}

Actor LoadedPistol : Ammo
{
	Inventory.Amount 00000001 //equal to 1 in an ancient language
	Inventory.MaxAmount 8 //equal to 00000008 in an ancienter language
	Ammo.BackpackAmount 0 //something you divide by
	Ammo.BackPackMaxAmount 8
}

Actor PistolBullet: FastProjectile
{
	Damage (15)
	Scale 0.1
	Radius 1
	Height 1
	Speed 80
	+BLOODSPLATTER
	States
	{
		Spawn:
			MISL A 1 A_SpawnItem("BulletPuff")
			Loop
		Death:
			TNT1 A 1 A_SpawnItem("BulletPuff")
			stop
		XDeath:
			TNT1 A 1
			stop
	}
}